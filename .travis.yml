sudo: false
language: node_js

node_js:
  - "lts/*"

cache:
  directories:
    - "node_modules"

env:
  - MOZ_HEADLESS=1

matrix:
  include:
    - os: linux
      addons:
        chrome: stable
        firefox: latest
    - os: osx
      addons:
        chrome: stable
        firefox: latest
    - os: windows

# Setup headless Firefox and Chrome support
# https://docs.travis-ci.com/user/gui-and-headless-browsers/#Using-the-Chrome-addon-in-the-headless-mode
before_install:
  - [[ "$TRAVIS_OS_NAME" == "linux" ]]   && google-chrome-stable --headless --disable-gpu --remote-debugging-port=9222 http://localhost &
  - [[ "$TRAVIS_OS_NAME" == "osx" ]]     && google-chrome-stable --headless --disable-gpu --remote-debugging-port=9222 http://localhost &
  - [[ "$TRAVIS_OS_NAME" == "windows" ]] && choco install firefox googlechrome

after_success:
  - npm install -g codecov
  - npm run coverage
  - codecov

notifications:
  email: false
  irc: "irc.mozilla.org#filer"
